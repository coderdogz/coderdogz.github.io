<!DOCTYPE html><html lang="zh-CN,en,zh-TW,default"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="做个俗人  贪财好色" href="http://example.com/rss.xml"><link rel="alternate" type="application/atom+xml" title="做个俗人  贪财好色" href="http://example.com/atom.xml"><link rel="alternate" type="application/json" title="做个俗人  贪财好色" href="http://example.com/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="逆向,安卓,Frida,抓包"><link rel="canonical" href="http://example.com/2021/05/23/%E6%8A%93%E5%8C%85%E6%80%BB%E7%BB%93%E8%AE%B0%E5%BD%95/"><title>抓包总结记录 - 逆向学习 | 折 花 酒 肆 = 做个俗人 贪财好色</title><meta name="generator" content="Hexo 6.3.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">抓包总结记录</h1><div class="meta"><span class="item" title="创建时间：2021-05-23 20:50:13"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2021-05-23T20:50:13+08:00">2021-05-23</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>3.9k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>4 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">折 花 酒 肆</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1giclg5ms2rj20zk0m8u0x.jpg"></li><li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1gicis081o9j20zk0m8dmr.jpg"></li><li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1giclflwv2aj20zk0m84qp.jpg"></li><li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1giclx29mstj20zk0m8hdt.jpg"></li><li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1giclil3m4ej20zk0m8tn8.jpg"></li><li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1gipetlbztpj20zk0m84qp.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0/" itemprop="item" rel="index" title="分类于 逆向学习"><span itemprop="name">逆向学习</span></a><meta itemprop="position" content="1"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="http://example.com/2021/05/23/%E6%8A%93%E5%8C%85%E6%80%BB%E7%BB%93%E8%AE%B0%E5%BD%95/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="折花载酒z"><meta itemprop="description" content=",    终是庄周梦了蝶      亦是情缘亦是劫"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="做个俗人  贪财好色"></span><div class="body md" itemprop="articleBody"><p>逆向学习中抓包的一点总结记录<span id="more"></span></p><h2 id="计算机网络基础"><a class="anchor" href="#计算机网络基础">#</a> 计算机网络基础</h2><blockquote><p>互联网所有的数据都是基于网络传输，所以懂点网络在逆向过程中也是必不可少的</p></blockquote><ul><li><p>http 与 https:</p><ul><li>https 是披着 ssl 外壳的 http</li><li><span class="exturl" data-url="aHR0cDovL3d3dy41MmltLm5ldC90aHJlYWQtMjg2Ni0xLTEuaHRtbA==">http://www.52im.net/thread-2866-1-1.html</span></li></ul></li><li><p>数据流向:</p><blockquote><p>TCP/IP 协议中，数据流向都是按着这个模式来，无出其右</p></blockquote><p><img data-src="https://cdn.jsdelivr.net/gh/coderdogz/img/20210521003445.png" alt=""></p></li></ul><blockquote><p>OSI 网络模型 和 TCP/IP 模型的对比</p></blockquote><p><img data-src="https://cdn.jsdelivr.net/gh/coderdogz/img/20210521004109.png" alt=""></p><blockquote><p>读完 图解 HTTP 的一点碎碎念</p></blockquote><ul><li>IP 协议与 IP 地址:<ul><li>我们经常说的 ip 一般表示 IP 地址，但是再谈到协议的时候 IP 一般指的是 IP 协议，并不是 IP 地址</li></ul></li><li>代理 IP 与代理服务器<ul><li>代理 IP 分为透明代理，高匿等<ol><li>透明代理：目标服务器知道你使用了代理，[原理为首部的 <code>via</code> , 说法来源于网上]</li><li>高匿代理：目标服务器不知道你使用了代理。这样会认为此次访问是一个真实的 IP 地址</li></ol></li><li>代理服务器分为透明代理服务器，缓存服务器<ol><li>透明代理服务器：不对请求响应内容处理的服务器，只做代理。对请求响应内容更改的的称作非透明代理服务器</li><li>缓存代理服务器：将响应内容缓存到服务器，如果源服务器未更新资源则返回缓存内容</li></ol></li></ul></li><li>未完待续</li></ul><h2 id="基于工具的抓包"><a class="anchor" href="#基于工具的抓包">#</a> 基于工具的抓包</h2><h3 id="charles-系统代理"><a class="anchor" href="#charles-系统代理">#</a> charles + 系统代理</h3><blockquote><p>很早期的做法，但是随着 android7 以上不信任系统证书和检测手段增多现在不推荐这种抓包方式</p><p>从 OSI 模型理解，修改系统代理的抓包方式，代理存在于应用层，而使用 VPN 转发的方式抓包在网络层。代理的位置更加底层，更难防护</p></blockquote><h3 id="charles-vpn代理工具"><a class="anchor" href="#charles-vpn代理工具">#</a> charles + VPN 代理工具</h3><blockquote><p>VPN 代理工具有很多，比如 Brook, postern, proxyDaivd, drony</p><p>笔者使用的是 postern, 觉得不怎么好，但是其他的用的也不怎么样好，相对之下选了一个相对好的就一直用了</p></blockquote><h4 id="抓包环境搭建"><a class="anchor" href="#抓包环境搭建">#</a> 抓包环境搭建</h4><ol><li><p>charles 安装与配置 [破解可耻，支持正版]</p><ol><li>官网下载最新版:<span class="exturl" data-url="aHR0cHM6Ly93d3cuY2hhcmxlc3Byb3h5LmNvbS9hc3NldHMvcmVsZWFzZS80LjYuMS9jaGFybGVzLXByb3h5LTQuNi4xX2FtZDY0LnRhci5neg==">https://www.charlesproxy.com/assets/release/4.6.1/charles-proxy-4.6.1_amd64.tar.gz</span> 解压即可使用</li><li>破解 (行为可耻，请勿模仿):<ul><li>在 https://www.charles.ren/ 填写 Registered Name, 并生成授权码</li><li><img data-src="https://cdn.jsdelivr.net/gh/coderdogz/img/20210524001004.png" alt=""></li><li><img data-src="https://cdn.jsdelivr.net/gh/coderdogz/img/20210524001051.png" alt=""></li></ul></li></ol></li><li><p>postern 安装与配置</p><ol><li>谷歌下载 postern</li><li><img data-src="https://cdn.jsdelivr.net/gh/coderdogz/img/20210524001259.png" alt=""></li><li><img data-src="https://cdn.jsdelivr.net/gh/coderdogz/img/20210524001344.png" alt=""></li><li><img data-src="https://cdn.jsdelivr.net/gh/coderdogz/img/20210524001413.png" alt=""></li></ol></li><li><p>证书安装</p><ol><li>charles 将证书导出到 PC, 导出为 pem 格式</li><li>计算文件名，文件名是一个 Hash 值，而后缀是一个数字。后缀名的数字是为了防止文件名冲突的，比如如果两个证书算出的 Hash 值是一样的话，那么一个证书的后缀名数字可以设置成 0，而另一个证书的后缀名数字可以设置成 1</li></ol><pre><code><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl x509 -subject_hash_old -in &lt;Certificate_File&gt;</span><br></pre></td></tr></table></figure>
</code></pre><ol start="3"><li><p>修改证书名称</p></li><li><p>复制证书到设备上</p><blockquote><p>复制到系统目录并修改权限（安卓 8.1.0 Magisk Root）</p></blockquote><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb push xxxxxxx.0 /sdcard/</span><br></pre></td></tr></table></figure><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mount -o rw,remount /system 【不修改 没法写入】</span><br><span class="line">mount -o rw,remount / </span><br><span class="line"><span class="built_in">mv</span> /sdcard/xxxxxxx.0 /etc/security/cacerts/ 移动文件到系统</span><br><span class="line"><span class="built_in">chown</span> root:root /etc/security/cacerts/xxxxxx.0 修改用户组</span><br><span class="line"><span class="built_in">chmod</span> 644 /system/etc/security/cacerts/xxxxxxx.0 修改权限</span><br></pre></td></tr></table></figure><p></p></li><li><p>重启手机验证</p><p><code>reboot</code></p><p>—by:r0syue</p></li></ol><blockquote><p>由于证书先安装到用户目录再移动到系统目录这样的操作会被 app 将此证书拉黑，如果曾经有过此操作最好先刷机在移动证书.</p></blockquote></li></ol><blockquote><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl x509 -subject_hash_old -in  &lt;Certificate_File&gt;报错 ：PEM routines:get_name:no start line:crypto\pem\pem_lib.c:745:Expecting: TRUSTED CERTIFICATE</span><br></pre></td></tr></table></figure><p></p></blockquote><blockquote><p>解决办法：使用这个命令 <code>openssl x509 -subject_hash_old -in &lt;Certificate_File&gt; -inform der</code> by: 嘴强王者<br>系统证书目录： <code>/system/etc/security/cacerts/</code></p></blockquote><h3 id="httpcanypacket-capture"><a class="anchor" href="#httpcanypacket-capture">#</a> HttpCany/Packet Capture</h3><blockquote><p>基于安卓手机。优点的话那就是省事。缺点的话可能是屏幕小</p></blockquote><h3 id="wireshark"><a class="anchor" href="#wireshark">#</a> Wireshark</h3><blockquote><p><span class="exturl" data-url="aHR0cHM6Ly9ib29rLmRvdWJhbi5jb20vc3ViamVjdC8yMTY5MTY5Mi8=">https://book.douban.com/subject/21691692/</span></p></blockquote><h3 id="tcpdump"><a class="anchor" href="#tcpdump">#</a> tcpdump</h3><blockquote><p><span class="exturl" data-url="aHR0cHM6Ly9qdWVqaW4uY24vcG9zdC82ODQ0OTA0MDg0MTY4NzY5NTQ5">https://juejin.cn/post/6844904084168769549</span></p></blockquote><h3 id="对抗"><a class="anchor" href="#对抗">#</a> 对抗</h3><h4 id="证书"><a class="anchor" href="#证书">#</a> 证书</h4><h5 id="证书锁定"><a class="anchor" href="#证书锁定">#</a> 证书锁定</h5><blockquote><p>在代码中指定证书 hash 值</p></blockquote><h5 id="反证书锁定"><a class="anchor" href="#反证书锁定">#</a> 反证书锁定</h5><ol><li><p>服务端校验客户端证书</p><ol><li><p>使用 objection 自带命令</p><p><code>android sslpinning disable</code></p><p><img data-src="https://cdn.jsdelivr.net/gh/coderdogz/img/20210521144416.png" alt=""></p></li><li><p>使用瘦蛟舞大佬的 DroidSSLUnpinning<br><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL1dvb3l1bkRvdGEvRHJvaWRTU0xVbnBpbm5pbmc=">https://github.com/WooyunDota/DroidSSLUnpinning</span></p></li><li><p>使用 <code>JustTrustMe</code> , 当然了珍惜大佬的升级版本也可以</p><ul><li><p>原版: <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0Z1emlvbjI0L0p1c3RUcnVzdE1l">https://github.com/Fuzion24/JustTrustMe</span></p></li><li><p>升级版: <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3cyOTY0ODgzMjAvWHBvc2VkT2tIdHRwQ2F0L3RyZWUvbWFzdGVyL2p1c3RUcnVzdE1lUGx1c2g=">https://github.com/w296488320/XposedOkHttpCat/tree/master/justTrustMePlush</span></p></li><li><p>分析文章: <span class="exturl" data-url="aHR0cHM6Ly9iYnMucGVkaXkuY29tL3RocmVhZC0yNTQxMTQuaHRt">https://bbs.pediy.com/thread-254114.htm</span></p></li></ul></li><li><p>自己分析 hook 点，去过掉证书锁定</p><ol><li>java.io.File</li><li>java.security.KeyStore</li><li>...</li></ol></li></ol></li><li><p>客户端校验服务端</p><p>未完待续...</p></li><li><p>双向验证</p><blockquote><p>典型的双向验证 Soul 分析，===&gt; <span class="exturl" data-url="aHR0cDovL3poYW94aW5jaGVuZy5jb20vaW5kZXgucGhwLzIwMjAvMDcvMTUvb3VsYXBwJUU3JTlBJTg0JUU1JThGJThDJUU1JTkwJTkxJUU4JUFGJTgxJUU0JUI5JUE2JUU3JUEwJUI0JUU4JUE3JUEzLw==">soul 双向证书破解</span></p></blockquote><p>未完待续...</p></li></ol><h4 id="检测系统代理"><a class="anchor" href="#检测系统代理">#</a> 检测系统代理</h4><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">System.getProperty(“http.proxyHost”); </span><br><span class="line">System.getProperty(“http.proxyPort”); </span><br></pre></td></tr></table></figure><p></p><h4 id="反系统代理检测"><a class="anchor" href="#反系统代理检测">#</a> 反系统代理检测</h4><blockquote><p>不使用系统代理的方式抓包，使用 VPN 代理方式</p></blockquote><h5 id="检测vpn"><a class="anchor" href="#检测vpn">#</a> 检测 VPN</h5><p></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">java.net.NetworkInterface.getName()</span><br><span class="line">android.net.ConnectivityManager.getNetworkCapabilities()</span><br></pre></td></tr></table></figure><p></p><h5 id="反vpn检测"><a class="anchor" href="#反vpn检测">#</a> 反 VPN 检测</h5><blockquote><p>分析 app,hook 掉检测</p></blockquote><blockquote><p>实战秀动 APP</p><p><span class="exturl" data-url="aHR0cHM6Ly9tcC53ZWl4aW4ucXEuY29tL3MvVWl4RXhaa1BXSEpBVDNqQUQyc0pKZw==">https://mp.weixin.qq.com/s/UixExZkPWHJAT3jAD2sJJg</span></p></blockquote><hr><ul><li>看完这篇文章并跟着做了一遍，发现代码都一样，但是就是过不了，于是就使出了瞎几把 hook 大法，将 <code>ConnectivityManager</code> 类全部 hook, 然后修改 <code>getActiveNetwork</code> 返回值，最后成功</li></ul><p></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(</span><br><span class="line">    <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> <span class="title class_">ConnectivityManager</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;android.net.ConnectivityManager&quot;</span>);</span><br><span class="line">        <span class="title class_">ConnectivityManager</span>.<span class="property">getActiveNetwork</span>.<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> <span class="title class_">Integer</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;android.net.Network&quot;</span>)</span><br><span class="line">            <span class="keyword">var</span> r1 = <span class="title class_">Integer</span>.$new(<span class="number">100</span>)</span><br><span class="line">            <span class="keyword">var</span> result = <span class="variable language_">this</span>.<span class="title function_">getActiveNetwork</span>();</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;result is =&gt; &quot;</span>, result);</span><br><span class="line">            <span class="keyword">return</span> r1;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;   </span><br><span class="line">)</span><br></pre></td></tr></table></figure><p></p><p><img data-src="https://cdn.jsdelivr.net/gh/coderdogz/img/20210523232011.jpg" alt=""></p><h5 id="文章收藏"><a class="anchor" href="#文章收藏">#</a> 文章收藏</h5><p><span class="exturl" data-url="aHR0cHM6Ly93d3cuYW5xdWFua2UuY29tL3Bvc3QvaWQvMTk3NjU3">https://www.anquanke.com/post/id/197657</span></p><p><span class="exturl" data-url="aHR0cHM6Ly9tcC53ZWl4aW4ucXEuY29tL3MvVWl4RXhaa1BXSEpBVDNqQUQyc0pKZw==">https://mp.weixin.qq.com/s/UixExZkPWHJAT3jAD2sJJg</span></p><p><span class="exturl" data-url="aHR0cHM6Ly93d3cuamlhbnNodS5jb20vcC8yNDc2Yzg4NThkYWY=">https://www.jianshu.com/p/2476c8858daf</span></p><p><span class="exturl" data-url="aHR0cHM6Ly9hcGktY2FsbGVyLmNvbS8yMDE5LzExLzA1L2NhcHR1cmUtbm90ZS8=">https://api-caller.com/2019/11/05/capture-note/</span></p><h3 id="hook-抓包"><a class="anchor" href="#hook-抓包">#</a> hook 抓包</h3><blockquote><p>这个仁者见仁智者见智，方法不尽相同，记录几个小工具，方便抄袭</p></blockquote><ul><li><p>OkHttpLogger-Frida</p><ul><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3NpeXVqaWUvT2tIdHRwTG9nZ2VyLUZyaWRh">siyujie/OkHttpLogger-Frida: Frida 实现拦截 okhttp 的脚本</span></li></ul></li><li><p>基于 Okhttp 拦截器实现的各种抓包</p><ul><li><span class="exturl" data-url="aHR0cHM6Ly9iYnMucGVkaXkuY29tL3RocmVhZC0yNTIxMDAuaHRt">https://bbs.pediy.com/thread-252100.htm</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9iYnMucGVkaXkuY29tL3RocmVhZC0yNTQ1MDMuaHRt">https://bbs.pediy.com/thread-254503.htm</span></li><li>未完待续</li></ul></li><li><p>r0capture</p><ul><li><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3IweXN1ZS9yMGNhcHR1cmU=">r0ysue/r0capture: 安卓应用层抓包通杀脚本</span></p><blockquote><p>hook <code>ssl_read</code> , <code>ssl_write</code></p><p>光看 hook 点可能觉得很简单，你上你也行，但是分析的过程很重要</p></blockquote></li></ul></li><li><p>自己分析，基于系统库的 hook</p></li></ul><h3 id="对抗-2"><a class="anchor" href="#对抗-2">#</a> 对抗</h3><ul><li>anti_frida</li><li>anti_xp</li></ul><h3 id="抓包骚操作"><a class="anchor" href="#抓包骚操作">#</a> 抓包骚操作</h3><ul><li><p>Android 结合 Wireshark 抓包，不用安装证书</p><ul><li><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2xhc3RpbmcteWFuZy9mcmlkYV9ieXBhc3Nfc3NsX2V4YW1wbGUvdHJlZS9tYXN0ZXIvQW5kcm9pZC9hbmRyb2lkX3dpcmVzaGFya190bHM=">https://github.com/lasting-yang/frida_bypass_ssl_example/tree/master/Android/android_wireshark_tls</span></p></li><li><p><span class="exturl" data-url="aHR0cHM6Ly93d3cuNTJwb2ppZS5jbi90aHJlYWQtMTQwNTkxNy0xLTEuaHRtbA==">https://www.52pojie.cn/thread-1405917-1-1.html</span></p></li></ul></li><li><p>高版本 android 证书问题</p><ul><li><p>将证书直接 push 到系统根目录下:</p><ul><li><p><img data-src="https://cdn.jsdelivr.net/gh/coderdogz/img/20210521165953.png" alt=""></p></li><li><p><span class="exturl" data-url="aHR0cHM6Ly93d3cuNTJwb2ppZS5jbi90aHJlYWQtMTE0ODg5Mi0xLTEuaHRtbA==">https://www.52pojie.cn/thread-1148892-1-1.html</span></p></li></ul></li><li><p>编译 ROM</p><ul><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuNTJwb2ppZS5jbi90aHJlYWQtMTM4MjY4OC0xLTEuaHRtbA==">https://www.52pojie.cn/thread-1382688-1-1.html</span></li></ul></li></ul></li></ul><div class="tags"><a href="/tags/%E9%80%86%E5%90%91/" rel="tag"><i class="ic i-tag"></i> 逆向</a> <a href="/tags/%E5%AE%89%E5%8D%93/" rel="tag"><i class="ic i-tag"></i> 安卓</a> <a href="/tags/Frida/" rel="tag"><i class="ic i-tag"></i> Frida</a> <a href="/tags/%E6%8A%93%E5%8C%85/" rel="tag"><i class="ic i-tag"></i> 抓包</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2021-05-24 22:11:13" itemprop="dateModified" datetime="2021-05-24T22:11:13+08:00">2021-05-24</time> </span><span id="2021/05/23/抓包总结记录/" class="item leancloud_visitors" data-flag-title="抓包总结记录" title="阅读次数"><span class="icon"><i class="ic i-eye"></i> </span><span class="text">阅读次数</span> <span class="leancloud-visitors-count"></span> <span class="text">次</span></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> 赞赏</button><p>请我喝[茶]~(￣▽￣)~*</p><div id="qr"><div><img data-src="/images/wechatpay.png" alt="折花载酒z 微信支付"><p>微信支付</p></div><div><img data-src="/images/alipay.png" alt="折花载酒z 支付宝"><p>支付宝</p></div><div><img data-src="/images/paypal.png" alt="折花载酒z 贝宝"><p>贝宝</p></div></div></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>折花载酒z <i class="ic i-at"><em>@</em></i>做个俗人 贪财好色</li><li class="link"><strong>本文链接：</strong> <a href="http://example.com/2021/05/23/%E6%8A%93%E5%8C%85%E6%80%BB%E7%BB%93%E8%AE%B0%E5%BD%95/" title="抓包总结记录">http://example.com/2021/05/23/抓包总结记录/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/2021/05/19/%E5%86%8D%E8%AF%BB-%E5%9B%BE%E8%A7%A3HTTP/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;tva4.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1gipewr8iypj20zk0m8b29.jpg" title="再读[图解HTTP]"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> 读书笔记</span><h3>再读[图解HTTP]</h3></a></div><div class="item right"><a href="/2022/10/22/hello-world/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;tva4.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1gipeun65urj20zk0m81ii.jpg" title="Hello World"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i></span><h3>Hello World</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80"><span class="toc-number">1.</span> <span class="toc-text">计算机网络基础</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8E%E5%B7%A5%E5%85%B7%E7%9A%84%E6%8A%93%E5%8C%85"><span class="toc-number">2.</span> <span class="toc-text">基于工具的抓包</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#charles-%E7%B3%BB%E7%BB%9F%E4%BB%A3%E7%90%86"><span class="toc-number">2.1.</span> <span class="toc-text">charles + 系统代理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#charles-vpn%E4%BB%A3%E7%90%86%E5%B7%A5%E5%85%B7"><span class="toc-number">2.2.</span> <span class="toc-text">charles + VPN 代理工具</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8A%93%E5%8C%85%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA"><span class="toc-number">2.2.1.</span> <span class="toc-text">抓包环境搭建</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#httpcanypacket-capture"><span class="toc-number">2.3.</span> <span class="toc-text">HttpCany&#x2F;Packet Capture</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#wireshark"><span class="toc-number">2.4.</span> <span class="toc-text">Wireshark</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#tcpdump"><span class="toc-number">2.5.</span> <span class="toc-text">tcpdump</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%B9%E6%8A%97"><span class="toc-number">2.6.</span> <span class="toc-text">对抗</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%81%E4%B9%A6"><span class="toc-number">2.6.1.</span> <span class="toc-text">证书</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%AF%81%E4%B9%A6%E9%94%81%E5%AE%9A"><span class="toc-number">2.6.1.1.</span> <span class="toc-text">证书锁定</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8F%8D%E8%AF%81%E4%B9%A6%E9%94%81%E5%AE%9A"><span class="toc-number">2.6.1.2.</span> <span class="toc-text">反证书锁定</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A3%80%E6%B5%8B%E7%B3%BB%E7%BB%9F%E4%BB%A3%E7%90%86"><span class="toc-number">2.6.2.</span> <span class="toc-text">检测系统代理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%8D%E7%B3%BB%E7%BB%9F%E4%BB%A3%E7%90%86%E6%A3%80%E6%B5%8B"><span class="toc-number">2.6.3.</span> <span class="toc-text">反系统代理检测</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%A3%80%E6%B5%8Bvpn"><span class="toc-number">2.6.3.1.</span> <span class="toc-text">检测 VPN</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8F%8Dvpn%E6%A3%80%E6%B5%8B"><span class="toc-number">2.6.3.2.</span> <span class="toc-text">反 VPN 检测</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%96%87%E7%AB%A0%E6%94%B6%E8%97%8F"><span class="toc-number">2.6.3.3.</span> <span class="toc-text">文章收藏</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#hook-%E6%8A%93%E5%8C%85"><span class="toc-number">2.7.</span> <span class="toc-text">hook 抓包</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%B9%E6%8A%97-2"><span class="toc-number">2.8.</span> <span class="toc-text">对抗</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8A%93%E5%8C%85%E9%AA%9A%E6%93%8D%E4%BD%9C"><span class="toc-number">2.9.</span> <span class="toc-text">抓包骚操作</span></a></li></ol></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li><a href="/2021/03/23/%E9%80%86%E5%90%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/" rel="bookmark" title="逆向环境搭建">逆向环境搭建</a></li><li><a href="/2021/03/26/frida-rpc-%E5%AD%A6%E4%B9%A0/" rel="bookmark" title="frida rpc 学习">frida rpc 学习</a></li><li><a href="/2021/04/22/%E7%BA%A6%E5%8D%95/" rel="bookmark" title="约单">约单</a></li><li><a href="/2021/05/07/%E7%A7%BB%E5%8A%A8TV/" rel="bookmark" title="移动TV">移动TV</a></li><li><a href="/2021/05/10/%E6%A8%B1%E8%8A%B1/" rel="bookmark" title="樱花">樱花</a></li><li class="active"><a href="/2021/05/23/%E6%8A%93%E5%8C%85%E6%80%BB%E7%BB%93%E8%AE%B0%E5%BD%95/" rel="bookmark" title="抓包总结记录">抓包总结记录</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="折花载酒z" data-src="/images/avatar.jpg"><p class="name" itemprop="name">折花载酒z</p><div class="description" itemprop="description">终是庄周梦了蝶 亦是情缘亦是劫</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">11</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">2</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">7</span> <span class="name">标签</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tLw==" title="https:&#x2F;&#x2F;github.com&#x2F;"><i class="ic i-github"></i></span> <span class="exturl item twitter" data-url="aHR0cHM6Ly9naXRodWIuY29tLw==" title="https:&#x2F;&#x2F;github.com&#x2F;"><i class="ic i-twitter"></i></span> <span class="exturl item zhihu" data-url="aHR0cHM6Ly9naXRodWIuY29tLw==" title="https:&#x2F;&#x2F;github.com&#x2F;"><i class="ic i-zhihu"></i></span> <span class="exturl item music" data-url="aHR0cHM6Ly9naXRodWIuY29tLw==" title="https:&#x2F;&#x2F;github.com&#x2F;"><i class="ic i-cloud-music"></i></span> <span class="exturl item weibo" data-url="aHR0cHM6Ly9naXRodWIuY29tLw==" title="https:&#x2F;&#x2F;github.com&#x2F;"><i class="ic i-weibo"></i></span> <span class="exturl item about" data-url="aHR0cHM6Ly9naXRodWIuY29tLw==" title="https:&#x2F;&#x2F;github.com&#x2F;"><i class="ic i-address-card"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>friends</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/2021/05/19/%E5%86%8D%E8%AF%BB-%E5%9B%BE%E8%A7%A3HTTP/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/2022/10/22/hello-world/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0/" title="分类于 逆向学习">逆向学习</a></div><span><a href="/2021/05/10/%E6%A8%B1%E8%8A%B1/" title="樱花">樱花</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" title="分类于 读书笔记">读书笔记</a></div><span><a href="/2021/05/19/%E5%86%8D%E8%AF%BB-%E5%9B%BE%E8%A7%A3HTTP/" title="再读[图解HTTP]">再读[图解HTTP]</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2022/10/31/RPC%E4%B8%BB%E5%8A%A8%E8%B0%83%E7%94%A8/" title="未命名">未命名</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0/" title="分类于 逆向学习">逆向学习</a></div><span><a href="/2021/05/07/%E7%A7%BB%E5%8A%A8TV/" title="移动TV">移动TV</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2022/10/22/hello-world/" title="Hello World">Hello World</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2022/10/31/python%E4%B8%BA%E8%A7%86%E9%A2%91%E6%B7%BB%E5%8A%A0%E6%B0%B4%E5%8D%B0/" title="未命名">未命名</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0/" title="分类于 逆向学习">逆向学习</a></div><span><a href="/2021/03/23/%E9%80%86%E5%90%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/" title="逆向环境搭建">逆向环境搭建</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2022/10/31/python%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%AD%A6%E4%B9%A0/" title="未命名">未命名</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0/" title="分类于 逆向学习">逆向学习</a></div><span><a href="/2021/03/26/frida-rpc-%E5%AD%A6%E4%B9%A0/" title="frida rpc 学习">frida rpc 学习</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E9%80%86%E5%90%91%E5%AD%A6%E4%B9%A0/" title="分类于 逆向学习">逆向学习</a></div><span><a href="/2021/04/22/%E7%BA%A6%E5%8D%95/" title="约单">约单</a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2010 – <span itemprop="copyrightYear">2022</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">折花载酒z @ 折 花 酒 肆</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">38k 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">35 分钟</span></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"2021/05/23/抓包总结记录/",favicon:{show:"（●´3｀●）やれやれだぜ",hide:"(´Д｀)大変だ！"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html>